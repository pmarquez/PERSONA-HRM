
$(function(){var c="ws://13.79.175.6:8080/Heimdall/dashboardUpdates";var n;var i=$("#globalUsageChart");var q={alpha:1,"background-color":"#f5f5f5","background-color-2":"#f5f5f5",type:"pie",stacked:"true","scale-y":{label:{text:"Percentage Occupation"}},series:[{values:[]}]};var r=$("#hourlyUsageChart");var f={alpha:1,"background-color":"#f5f5f5","background-color-2":"#f5f5f5",type:"bar",stacked:"false","scale-y":{label:{text:"Times Sensor Used per Hour (24 Hours)"}},series:[{values:[]}]};l();function l(){n=new WebSocket(c);n.onmessage=function(s){m(s)};n.onerror=function(s){e(s)};n.onopen=function(s){d(s)};window.addEventListener("beforeunload",o,false);i.zingchart();i.zingchart({JSON:q});r.zingchart();r.zingchart({JSON:f})}function m(s){console.log("received over websockets: "+s.data);var t=$.parseJSON(s.data);if(t.dashboard!==undefined){b(t)}else{"No Data To Update"}}function e(s){console.log("ERROR: "+s.data)}function d(){console.log("Connected to: "+c)}var j=document.getElementById("output");function g(){n.send("stopMonitor");buttonStates("stoppedState")}function p(){n.send("closeConnection");buttonStates("closedState")}function k(){n.close()}function o(){g();k()}function b(s){h(s.dashboard[0]);a(s.dashboard[1])}function h(t){var v={series:[]};var u;var s;$.each(t.data,function(w,x){u=new Object();s=new Array();s.push(x.useCount);u.text=x.sensorName;u.values=s;v.series.push(u)});console.log(JSON.stringify(v));i.setJSON(v)}function a(w){var t=new Array();var v=new Array();var u;var s=w.data[0].sensorName;$.each(w.data,function(y,z){if(s===z.sensorName){t.push(z.useCount)}else{s=z.sensorName;u=new Object();u.values=t;v.push(u);t=new Array();t.push(z.useCount)}});u=new Object();u.values=t;v.push(u);var x=new Object();x.series=v;r.setJSON(x)}});